<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gym Timer</title>
<style>

  body {
    font-family: sans-serif;
    margin: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #111111;
    color: #ffffff;
    background: #000000; /* full black background */
    transition: background 2s ease-in-out; /* smooth color change */
  }

  .container {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 80%;
    max-width: 400px;
  }

  #time {
    font-size: 5em;
    font-weight: 400;
    margin-bottom: 20px;
    text-align: center;
    color: #ffffff;
  }

  button {
    flex: 1;
    font-size: 1.5em;
    padding: 12px 25px;
    color: #ffffff;
    border-radius: 8px;
    transition: transform 0.2s ease;
  }

    button:active {
    transform: scale(0.95);
  }

  #workBtn {
    width: 100%;
    font-size: 1.5em;
    font-weight: 500;
    padding: 14px;
    margin-bottom: 15px;
  }

  .working {
    color: #B5FEC6;
    background: #18251B;
    border: 1px solid #166526;
  }

  .resting {
    color: #FFDFB4;
    background: #312000;
    border: 1px solid #7C5100;
  }

  .button-row {
    display: flex;
    width: 100%;
    gap: 15px;
    margin-bottom: 20px;
  }

  .control-btn {
    background: #232323;
    border: 1px solid #444444;
    color: #cccccc;
  }

  #info {
    display: flex;
    justify-content: space-between;
    width: 100%;
    font-size: 1em;
    color: #cccccc;
  }

  
</style>
</head>
<body>

<div class="container">

  <div id="time">00:00:00</div>

  <button id="workBtn" class="working">Working out</button>

  <div class="button-row">
    <button id="startPauseBtn" class="control-btn">Play</button>
    <button id="resetBtn" class="control-btn">Reset</button>
  </div>

  <div id="info">
    <div id="totalTime">Total: 00:00:00</div>
    <div id="laps">Laps: 0</div>
  </div>

</div>

<script>
let startTime = 0;
let elapsedBeforePause = 0;
let totalStartTime = 0;
let totalElapsed = 0;
let timer;
let isPaused = true;
let isWorking = true;
let laps = 0;

function formatTime(ms) {
  let minutes = Math.floor(ms / 60000);
  let seconds = Math.floor((ms % 60000) / 1000);
  let milliseconds = Math.floor((ms % 1000) / 10);
  return `${minutes.toString().padStart(2,'0')}:` +
         `${seconds.toString().padStart(2,'0')}:` +
         `${milliseconds.toString().padStart(2,'0')}`;
}

function updateTime() {

  if (!isPaused) {
    let elapsed = Date.now() - startTime + elapsedBeforePause;
    document.getElementById('time').textContent = formatTime(elapsed);
  }

  if (totalStartTime !== 0) {
    totalElapsed = Date.now() - totalStartTime;
    document.getElementById('totalTime').textContent =
      "Total: " + formatTime(totalElapsed);
  }

  document.getElementById('laps').textContent = "Laps: " + laps;
}

function startStopwatch() {
  clearInterval(timer);
  timer = setInterval(updateTime, 10);
}

// Start / Pause
document.getElementById('startPauseBtn').addEventListener('click', () => {

  if (isPaused) {

    if (totalStartTime === 0) {
      totalStartTime = Date.now();
    }

    startTime = Date.now();
    isPaused = false;
    document.getElementById('startPauseBtn').textContent = "Pause";
    startStopwatch();

  } else {

    clearInterval(timer);
    elapsedBeforePause += Date.now() - startTime;
    isPaused = true;
    document.getElementById('startPauseBtn').textContent = "Play";

  }

});

// Working out / Resting
document.getElementById('workBtn').addEventListener('click', () => {

  if (totalStartTime === 0) {
    totalStartTime = Date.now();
  }

  isWorking = !isWorking;

  const workBtn = document.getElementById('workBtn');

  if (isWorking) {
    workBtn.textContent = "Working out";
    workBtn.classList.remove("resting");
    workBtn.classList.add("working");
  } else {
    workBtn.textContent = "Resting";
    workBtn.classList.remove("working");
    workBtn.classList.add("resting");
  }

  startTime = Date.now();
  elapsedBeforePause = 0;
  isPaused = false;

  document.getElementById('startPauseBtn').textContent = "Pause";

  laps++;
  startStopwatch();

});

// Reset
document.getElementById('resetBtn').addEventListener('click', () => {

  clearInterval(timer);

  startTime = 0;
  elapsedBeforePause = 0;
  totalStartTime = 0;
  totalElapsed = 0;
  laps = 0;

  isPaused = true;
  isWorking = true;

  document.getElementById('time').textContent = "00:00:00";
  document.getElementById('totalTime').textContent = "Total: 00:00:00";
  document.getElementById('laps').textContent = "Laps: 0";

  const workBtn = document.getElementById('workBtn');
  workBtn.textContent = "Working out";
  workBtn.classList.remove("resting");
  workBtn.classList.add("working");

  document.getElementById('startPauseBtn').textContent = "Play";

});

updateTime();

let blinkInterval;

function startRestBlink() {
  clearInterval(blinkInterval);
  let toggle = false;
  blinkInterval = setInterval(() => {
    if (!isWorking) { // only blink during resting
      document.body.style.background = toggle ? "#000000" : "#1C1C1C";
      toggle = !toggle;
    } else {
      document.body.style.background = "#000000"; // reset when working
    }
  }, 500); // 500ms = half-second blink
}

startRestBlink(); // start the loop


// iOS hack: force :active on touch
document.querySelectorAll('button').forEach(btn => {
  btn.addEventListener('touchstart', ()=>{}, {passive:true});
});

</script>

</body>
</html>
